<!DOCTYPE html>
<html>

<head>
  <title>กำลังเข้าสู่ Form</title>
  <style>
    .centerScreen {
      margin-top: 20px;
      margin-right: auto;
      margin-bottom: 20px;
      margin-left: auto;
    }
  </style>
</head>

<body style="background-color: #ffd1fa;">
  <div class="centerScreen">
    <center>
      <img src="https://ongkub.github.io/KIDNOW_demo_Form/images/KidNow.png" height="200px" width="200px" />
      <h1>
        คุณกำลังเข้าสู่ระบบ กรุณารอซักครู่
      </h1>
    </center>
  </div>

  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    async function getUserProfile() {
      const profile = await liff.getProfile();
      return profile;
    }

    async function main() {
      await liff.init({ liffId: "1577116421-kM4mRp3Z" });

      if (liff.isLoggedIn()) {
        const profile = await getUserProfile();
        
        // Construct the redirect URL with pre-filled data
        const redirectUrl = `https://script.google.com/macros/s/AKfycbwInYCG1xXc2-GSBlA3wijurwgwJoKwLE31lvLf4gS6ibJfH1bTc6N7yHfsMbSMzhZE/exec?UID=${profile.userId}`;
        
        // Redirect the user
        window.location.replace(redirectUrl);
      } else {
        liff.login();
      }
    }

    main();
  </script>
</body>

</html>
